<!DOCTYPE html>
<html>
<head>


    <!-- Document Settings -->
    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />


    <!--syntax.css 추가-->
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />

    <!--font awesome-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!--font -->
    <link rel="preconnect" href="https://fonts.gstatic.com">

    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic&family=Source+Sans+Pro:wght@300;400;600&display=swap" rel="stylesheet">
    <!-- custom.css -->
    <link rel="stylesheet" type="text/css" href="/assets/built/custom.css" />
    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!--[if IE]>
        <style>
            p, ol, ul{
                width: 100%;
            }
            blockquote{
                width: 100%;
            }
        </style>
    <![endif]-->
    
    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="개발 공부하는 블로그" />
    <link rel="shortcut icon" href="https://heejung-gjt.github.io/assets/built/images/favicon.png" type="image/png" />
    <link rel="canonical" href="https://heejung-gjt.github.io/cookie" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="Studying  Develop" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Cookie, Session, Cache" />
    <meta property="og:description" content="쿠키 웹 사이트에 접속시 정보가 접속자 즉, 클라이언트의 로컬에 저장되는 작은 텍스트 파일이다 ex) 쇼핑몰 사이트에 로그인 하지 않고 장바구니에 상품을 등록해놓은 후 나갔다가 다시 들어와도 상품이 여전히 등록될 수 있게 하는 역할을 해준다 쿠키 동작 순서 클라이언트가 페이지를 요청한다 웹 서버가 요청을 받은 후 쿠키를 생성한다 생성한 쿠키에 정보를" />
    <meta property="og:url" content="https://heejung-gjt.github.io/cookie" />
    <meta property="og:image" content="https://heejung-gjt.github.io/assets/built/images/computer03.png" />
    <meta property="article:publisher" content="https://www.facebook.com/" />
    <meta property="article:author" content="https://www.facebook.com/" />
    <meta property="article:published_time" content="2021-09-06T14:32:00+09:00" />
    <meta property="article:modified_time" content="2021-09-06T14:32:00+09:00" />
    <meta property="article:tag" content="Network" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Cookie, Session, Cache" />
    <meta name="twitter:description" content="쿠키 웹 사이트에 접속시 정보가 접속자 즉, 클라이언트의 로컬에 저장되는 작은 텍스트 파일이다 ex) 쇼핑몰 사이트에 로그인 하지 않고 장바구니에 상품을 등록해놓은 후 나갔다가 다시 들어와도 상품이 여전히 등록될 수 있게 하는 역할을 해준다 쿠키 동작 순서 클라이언트가 페이지를 요청한다 웹 서버가 요청을 받은 후 쿠키를 생성한다 생성한 쿠키에 정보를" />
    <meta name="twitter:url" content="https://heejung-gjt.github.io/" />
    <meta name="twitter:image" content="https://heejung-gjt.github.io/assets/built/images/computer03.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Studying  Develop" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Network" />
    <meta name="twitter:site" content="@" />
    <meta name="twitter:creator" content="@" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "Studying  Develop",
        "logo": "https://heejung-gjt.github.io/"
    },
    "url": "https://heejung-gjt.github.io/cookie",
    "image": {
        "@type": "ImageObject",
        "url": "https://heejung-gjt.github.io/assets/built/images/computer03.png",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://heejung-gjt.github.io/cookie"
    },
    "description": "쿠키 웹 사이트에 접속시 정보가 접속자 즉, 클라이언트의 로컬에 저장되는 작은 텍스트 파일이다 ex) 쇼핑몰 사이트에 로그인 하지 않고 장바구니에 상품을 등록해놓은 후 나갔다가 다시 들어와도 상품이 여전히 등록될 수 있게 하는 역할을 해준다 쿠키 동작 순서 클라이언트가 페이지를 요청한다 웹 서버가 요청을 받은 후 쿠키를 생성한다 생성한 쿠키에 정보를"
}
    </script>

    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="Cookie, Session, Cache" href="/feed.xml" />

    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LESPMGXKR3"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-LESPMGXKR3');
</script>
</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="https://heejung-gjt.github.io/">Studying  Develop</a>
            
        
        
            
<ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
    <!-- <li class="nav-about" role="menuitem"><a href="/about/">About</a></li> -->
    <li class="nav-jekyll" role="menuitem"><a href="/tag/html/">HTML&CSS</a></li>
    <li class="nav-python" role="menuitem"><a href="/tag/js/">JavaScript</a></li>
    <li class="nav-python" role="menuitem"><a href="/tag/python/">Python</a></li>
    <li class="nav-python" role="menuitem"><a href="/tag/django/">Django</a></li>
    <li class="nav-python" role="menuitem"><a href="/tag/celery/">Celery</a></li>
    <li class="nav-python" role="menuitem"><a href="/tag/rabbitmq/">RabbitMQ</a></li>
    <li class="nav-python" role="menuitem"><a href="/tag/oauth/">OAuth</a></li>
    <li class="nav-python" role="menuitem"><a href="/tag/jwt/">JWT</a></li>
    <li class="nav-jekyll" role="menuitem"><a href="/tag/linux/">linux</a></li>
    <li class="nav-python" role="menuitem"><a href="/tag/algorithm/">algorithm</a></li>
    <li class="nav-python" role="menuitem"><a href="/tag/network/">Network</a></li>
    <li class="nav-python" role="menuitem"><a href="/tag/os/">OS</a></li>
    <li class="nav-python" role="menuitem"><a href="/tag/database/">DataBase</a></li>
    <li class="nav-python" role="menuitem"><a href="/tag/aws/">AWS</a></li>
    <li class="nav-jekyll" role="menuitem"><a href="/tag/git/">Git</a></li>
    <li class="nav-jekyll" role="menuitem"><a href="/tag/til/">TIL</a></li>


<!--    <li class="nav-archive" role="menuitem">-->
<!--        <a href="_includes/archive.html">All Posts</a>-->
<!--    </li>-->
</ul>
        
    </div>
    <!-- subscribe 안함
    <div class="site-nav-right">
        <div class="social-links">
            
            
        </div>
        
            <a class="subscribe-button" href="#subscribe">Subscribe</a>
        
    </div>-->
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full  tag-network post tag network ">

            <header class="post-full-header">

              <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="2021-09-06">2021-09-06</time>
                    
                        <span class="date-divider">/</span>
                        
                            
                               <a href='/tag/network/'>NETWORK</a>
                            
                        
                    
                </section>
                <h1 class="post-full-title">Cookie, Session, Cache</h1>
            </header>

<!--  
            
            <figure class="post-full-image" style="background-image: url(/assets/built/images/computer03.png)">
            </figure>
            
-->

            <section class="post-full-content">
                <div class="kg-card-markdown">
                    <!--<span class="table-of-contents-list">Network 정리 </span>-->
<!--<ul class="table-of-contents-list">-->
<!--    <li><a href="./structure">스택과 큐의 특징</a></li>-->
<!--    <li><a href="./heap">힙의 특징</a></li>-->
<!--</ul>-->

<p><br /></p>

<h2 id="쿠키">쿠키</h2>
<p>웹 사이트에 접속시 정보가 접속자 즉, 클라이언트의 로컬에 저장되는 작은 텍스트 파일이다</p>

<p>ex) 쇼핑몰 사이트에 로그인 하지 않고 장바구니에 상품을 등록해놓은 후 나갔다가 다시 들어와도 상품이 여전히 등록될 수 있게 하는 역할을 해준다</p>

<h3 id="쿠키-동작-순서">쿠키 동작 순서</h3>

<ol>
  <li>클라이언트가 페이지를 요청한다</li>
  <li>웹 서버가 요청을 받은 후 쿠키를 생성한다</li>
  <li>생성한 쿠키에 정보를 담아서 클라이언트에게 응답할때 함께 보낸다</li>
  <li>쿠키를 받은 클라이언트가 다시 서버에 요청할때 함께 전송한다</li>
  <li>웹 서버는 업데이트할 정보가 있으면 쿠키를 업데이트하여 다시 응답과 함께 전송한다</li>
</ol>

<p>클라이언트가 브라우저에 자신의 정보를 담고 있기 때문에 데이터를 요청할때 쿠키를 생성하고 브라우저를 종료할때 쿠키를 삭제한다</p>

<p><strong>(이때 쿠키는 최대 400개의 쿠키를 저장할 수 있고 몇몇개의 제약 조건이 존재한다)</strong></p>

<p><br /></p>

<h2 id="세션">세션</h2>
<p>쿠키를 기반으로 하고 있지만 사용자의 정보를 브라우저에 저장하는 쿠키와는 달리 세션은 서버측에서 관리하고 있다. 일정시간동안 같은 사용자로부터 들어오는 요구를 하나의 상태로 보고 그 상태를 일정하게 유지시켜주는 기술이다.</p>

<h4 id="세션-동작-순서">세션 동작 순서</h4>
<ol>
  <li>클라이언트가 서버로 접속을 시도한다</li>
  <li>서버는 접근한 클라이언트의 쿠키를 확인하여 클라이언트가 해당 세션 id를 보냈는지 확인한다</li>
  <li>세션 id가 존재하지 않으면 서버는 세션id를 생성해 클라이언트에게 돌려준다</li>
  <li>서버에서 클라이언트로 돌려준 세션id를 쿠키를 사용해 서버에 저장한다</li>
  <li>클라이언트는 재접속시 해당 쿠키를 서버에 보내 세션 id를 서버에 전달한다</li>
</ol>

<p><br /></p>

<h2 id="쿠키-vs-세션">쿠키 vs 세션</h2>

<p>쿠키와 세션은 보안과 저장위치, 라이프 사이클의 차이가 있다. 쿠키는 브라우저에 저장되어 있기 때문에 서버에 접근할 필요가 없어 응답 속도가 빠른 반면에 데이터가 변질되거나 스니핑 당할 위험이 있어 보안에 취약하다. 세션은 서버에 저장되어 있기 때문에 서버의 접근이 필요하다. 그렇기에 쿠키에 비해 응답 속도가 느린 편이다. 하지만 서버에서 처리하기 때문에 비교적 보안성이 좋다.</p>

<p>쿠키와 세션 둘 다 만료시간을 정할 수 있다. 세션의 경우에는 만료시간에 상관없이 브라우저가 종료되면 정보가 삭제가 된다. 쿠키의 경우 브라우저를 종료해도 만료시간이 남아 있는 경우 정보가 삭제되지 않는다.</p>

<p><br /></p>

<h2 id="캐시">캐시</h2>
<p>필요해 하는 데이터를 로컬등에 미리 저장해두어 보다 빠르게 데이터를 받아볼 수 있게 해주는 역할을 한다. (페이지 로딩 속도 개선)  <br />
캐시를 이용해 cdn같은 서비스도 할 수 있다. cdn은 컨텐츠 즉, 데이터를 배달, 딜리버리해주는 서버이다. 다른 지역에서 데이터를 요청하는 경우 지역 중간의 서버에 미리 올려놓은 데이터에 접근하게 해주어 보다 빠르게 응답을 해줄 수 있다.</p>

<blockquote>
  <p>단점      <br />
 캐시로 인해 저장된 데이터 공간은 영구적인 메모리 공간이 아니기 때문에 데이터가 지워질 수 있다는 것을 유념해야한다. 캐시에 저장되어 있던 파일들이 업데이트가 된 경우 바로바로 업데이트 된 파일을 가져올 수 없을 수 있다는 단점이 있다.</p>
</blockquote>

<p>ex) 종종 변경되어야 하는 데이터가 업데이트 되지 않을때가 있다면 캐시가 이유일 수 있다. (캐시는 서버의 캐시클라우드라는 저장공간에 사용자의 의지와 상관없이 자동 저장되기 때문이다) 웹개발시 css가 업데이트 되지 않는 원인 중 하나가 된다.</p>

<p><br /></p>

<h2 id="session-based-auth-vs-token-based-authjwt">Session based auth vs Token based auth(JWT)</h2>
<p>대표적으로 로그인을 할때 로그인이 유지되는 방식은 위의 2가지가 존재한다.</p>

<blockquote>
  <p>session based auth 동작 방식</p>
  <ol>
    <li>클라이언트가 서버에게 id, pwd를 post요청으로 보낸다</li>
    <li>서버에서 받은 id,pwd가 db와 일치하게 되면 클라이언트에게 알맞은 응답을 보낸다</li>
    <li>로그인에 성공하게 되면 서버에서 세션을 생성한다(세션id, 유저id, timeout등의 정보가 담긴다)</li>
    <li>클라이언트에게 쿠키안에 세션id를 담아서 보낸다</li>
    <li>이후 클라이언트가 요청을 보낼때 쿠키를 함께 보낸다</li>
    <li>세션id가 서버안에 존재하면 로그인이 되어졌을때의 페이지를 보여준다</li>
  </ol>
</blockquote>

<h4 id="session방식의-한계">session방식의 한계</h4>
<p>해당 작업은 I/O가 상당히 높은 작업이 된다. 서버 내부에 세션을 RAM이라는 공간에 DB형식으로 저장해 놓는데 이렇게 저장이 되는 경우
사용자가 많아지면 하나의 서버로 해결하기에는 한계가 있다</p>

<p>세션 전용 DB를 만들어 해당 DB에 세션ID를 저장해두어 사용할 수 있지만 (로드밸런싱의 단점 보완) 모든 트래픽이 DB에 몰리는 문제가 발생한다</p>

<p>DB를 분배형식으로 나누어 해결할 수 있다</p>

<p>JWT 토큰 방식을 사용하여 효율적으로 해결 할 수 도 있다</p>

<h4 id="token-based-auth-동작-방식">token based auth 동작 방식</h4>

<ol>
  <li>클라이언트가 id와 pwd를 서버에 보내고 서버는 해당 값을 받아 인증 한 후 토큰을 발급한다</li>
  <li>이후 클라이언트는 요청을 할때 해당 토큰을 가지고 데이터를 요청한다</li>
  <li>서버에서는 해당 토큰이 맞다고 확인되면 그에 맞는 권한을 클라이언트에게 준다 (세션과는 달리 서버에서 내부적으로 세션을 관리하지 않는다)</li>
  <li>서버에서 토큰이 올바른지만 확인하여 권한을 할당해준다 (오로지 요청안에 들어있는 토큰만을 보고 권한을 준다)</li>
</ol>

<p>대표적으로 JWT 토큰이 사용된다. 
(jwt의 포맷은 header(어떤 알고리즘으로 암호화 할것인지) - payload(data등을 넣어준다, Ex) 언제 토큰이 끝나는지 원하는 정보를 넣을 수 있다,  네트워크에 정보가 올라가기 때문에 최소한의 정보를 넣는게 좋다) - signiture(이부분만 암호화 된다.))</p>

<p><br /><br /></p>

<p>Q1. 다수의 서버를 이용한다는 것은 무엇을 의미하는가</p>

<p>Q2. 쿠키 헤더에 존재하는 도메인과 경로는 무엇을 말하는가
A2. HTTP 프로토콜의 쿠키헤더에는 <code class="highlighter-rouge">Set-Cookie: name=value [; expires=date] [; path=path] [; domain=domain] [; secure]</code>리소스들이 존재한다</p>
<ul>
  <li>
    <p>expires : 쿠키의 만료일 문자열이다. 쿠키의 유효한 날자가 날짜 형식으로 써져있다.</p>
  </li>
  <li>
    <p>domain : 쿠키가 적용되야하는 호스트를 지정한다. 지정하지 않으면 현재 URI를 기준으로 적용된다</p>
  </li>
</ul>

<blockquote>
  <p>호스트란 ?  <br />
네트워크에 연결되어 있는 컴퓨터들</p>
</blockquote>

<blockquote>
  <p>호스트 설정이란 ?  <br />
도메인을 호스트의 ip에 연결하는 행위이다
```</p>
</blockquote>

<ul>
  <li>
    <p>path : 쿠키 헤더를 서버에서 보내기 전에 요청된 리소스에 있어야하는 url경로를 나타낸다. 즉 path에 지정된 값과 일치하는 url요청에 대해 쿠키를 전송하도록 만드는 옵션이다</p>
  </li>
  <li>
    <p>secure : 보안 쿠키를 적용하는 옵션으로 서버에서 요청은 ssl을 사용하며 https를 상용할때만 전송할 수 있다</p>
  </li>
</ul>

                </div>
            </section>
        
        <div id="post-disqus" class="container">
            <div id="disqus_thread"></div>
<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://heejung-gjt-github-io.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

        </div>
        



    </div>
</main>

        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://heejung-gjt.github.io/">Studying  Develop</a> &copy; 2021</section>
                <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> &
                    <a href="https://github.com/heejung-gjt" target="_blank" rel="noopener">heejung's GitHub Pages</a>
<!--                    <a href="https://github.com/jekyller/jasper2" target="_blank" rel="noopener"></a>-->
                </section>
                <nav class="site-footer-nav">
<!--                    <a href="/">Latest Posts</a>-->
                    
                    
                    <a href="https://heejung-gjt.github.io" target="_blank" rel="noopener">github blog</a>
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    
        <div id="subscribe" class="subscribe-overlay">
            <a class="subscribe-overlay-close" href="#"></a>
            <div class="subscribe-overlay-content">
                
                <h1 class="subscribe-overlay-title">Subscribe to Studying  Develop</h1>
                <p class="subscribe-overlay-description">Stay up to date! Get all the latest &amp; greatest posts delivered straight to your inbox</p>
<!--                <!--
<form method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  /><input class="location" type="hidden" name="location"  /><input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email"  placeholder="youremail@example.com" />
    </div>
    <button class="" type="submit" disabled><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>
-->-->
            </div>
        </div>
    

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'G-LESPMGXKR3', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->
    <script id="dsq-count-scr" src="//heejung-gjt-github-io.disqus.com/count.js" async></script>
</body>
</html>
